# recoverNetwork

Instructions and implementation package of "Identifying Network Ties from Panel Data: Theory and an Application to Tax Competition" by De Paula, Rasul and Souza (fortcoming at the Review of Economic Studies).

## Simple example

Generate some simple data using the function `gendata`. It accepts two inputs:

1. `seed` fixes the random number generating seed
2. `setting` is an index that captures all the simulation parameters. For example, `setting=15` corresponds to the main simulations as described in Appendix C.1 for the Erd√∂s-Renyi network with `N=30` and `T=50`. 

```html
data <- gendata(setting=15,seed=1)
```

The data generated by gendata contains the unit and time identifiers, `id` and `time`, the outcome `y` and the explanatory variable(s) labeled sequentially as `x1`, `x2`, ... . The data is required to follow this structure and labeling of the variables.

The main function is `recoverNetwork` which accepts the `data` and the penalization parameters as a vector in the format `(p1,p1star,p2)`. It should take 1-2 mins to run for `N=30` and `T=50`. Note that computational time it is highly dependent on `N`. 

```html
rn <- recoverNetwork(data,lambda=c(0.10,0.10,0.10))
```

where `rn` is a list. The most important parts follow from the last-step unpenalised GMM, and are

```html
rn$unpenalisedgmm$rho
rn$unpenalisedgmm$beta
rn$unpenalisedgmm$gamma
```

and the estimated network is stored in 

```html
rn$unpenalisedgmm$W
```

## `recoverNetwork` optional arguments

As explained above, the main function is `recoverNetwork` which has two mandatory arguments (`data` and `lambda`). Optional arguments are

- `exoeffects`: restricts gamma=0 with `exoeffects=0`. Default is `exoeffects=1`.
- `docv`: does the cross-validation for the selection of penalisation parameters. This is heavily computationally intensive and not discussed/supported in the paper. Default is `docv=0`.
- `timeweights`: introduces time weights which is either 1 (default) or a vector with the same length as the number of time periods. This allows for re-weighting the observations and estimate the version of the codes with dynamic W.
- `eta`: this is used in the computation of the initial conditions explained in step 4 in Appendix B.2. Default is 0.05.
- `Wder`: is the derivative of the objective function with respect to the elements of Wif. This can be user-supplied to avoid the computational cost of computing the derivative at every turn. Computational gains for larger can be substantial. Default is NA.
- `adaestmethod`: selection of estimation method for the adaptive step. Only supported version (default) is `cvxr`.
-  `dopostols`: equal to 1 if post-OLS is to be performed. Default is not using post-OLS, so `dopostols=0`, and final estimates are drawn from the unpenalized GMM.
- `Wfixed`: used if part of the network is known. In this case, supply a NxN matrix with NA in the (i,j)th elements that are not known (and thus to be estimated), and with the known network intensity in the elements that are known. Supply `Wfixed=-1` (default) if network is entirely unknown and to be estimated.
